{"id":"buh-08q","title":"Fix: Messages silently dropped when slaEnabled=false","description":"message.handler.ts:96-103 делает early return ДО логирования в ChatMessage когда !slaEnabled. Фикс: оставить только !monitoringEnabled в раннем return, добавить !slaEnabled check ПОСЛЕ логирования (после line 181)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T20:18:13.455454247+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T20:25:56.760663798+03:00","closed_at":"2026-02-11T20:25:56.760663798+03:00","close_reason":"Fixed: moved SLA check after message logging in message.handler.ts — messages always logged to ChatMessage, SLA classification gated separately","external_ref":"gh-31a"}
{"id":"buh-0sl","title":"DEV MODE: Backend ENV Configuration","description":"Add DEV_MODE and DEV_USER_EMAIL to env.ts schema with proper validation. Export isDevMode helper function.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:06.153147623+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.5933972+03:00","closed_at":"2026-01-30T17:34:34.5933972+03:00","close_reason":"Implemented"}
{"id":"buh-1t9","title":"Add frontend unit tests for ChatSettingsForm","description":"Code review: test submit payload includes all fields, toggle state, form validation. File: frontend/src/components/chats/__tests__/ChatSettingsForm.test.tsx","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T12:29:50.545316327+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T12:57:01.576322955+03:00","closed_at":"2026-02-12T12:57:01.576322955+03:00","close_reason":"Frontend unit tests for ChatSettingsForm: 34 tests covering rendering, defaults, form submission, mutation callbacks, warnings, errors, interactions, edge cases"}
{"id":"buh-1v0","title":"Change request resolution from FIFO to LIFO","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:44:35.485647435+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:46:43.78939+03:00","closed_at":"2026-01-30T13:46:43.78939+03:00","close_reason":"Implemented FIFO→LIFO: findLatestPendingRequest with desc ordering","external_ref":"gh-15"}
{"id":"buh-21m","title":"DEV MODE: Frontend tRPC Client","description":"Modify frontend/src/lib/trpc.ts to send X-Dev-Mode header when isDevMode is true.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:18.350260118+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:36:16.02395991+03:00","closed_at":"2026-01-30T17:36:16.02395991+03:00","close_reason":"Implemented","dependencies":[{"issue_id":"buh-21m","depends_on_id":"buh-3wu","type":"blocks","created_at":"2026-01-30T17:32:33.309007332+03:00","created_by":"Igor Maslennikov"}]}
{"id":"buh-2d7","title":"Enhancement: Validate accountant @username against Telegram/DB (gh-38-a)","status":"closed","priority":3,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:43:04.731342065+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T12:38:13.242407752+03:00","closed_at":"2026-02-12T12:38:13.242407752+03:00","close_reason":"Implemented non-blocking username validation against DB with warnings display"}
{"id":"buh-2vc","title":"Auto-send SLA breach notification to group chat","status":"closed","priority":3,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:44:38.511395968+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:53:03.456259467+03:00","closed_at":"2026-01-30T13:53:03.456259467+03:00","close_reason":"Implemented notifyInChatOnBreach: Prisma field, worker logic, format function, UI toggle","external_ref":"gh-12"}
{"id":"buh-3fb","title":"P1: Fix recovery logic to use global manager fallback","description":"timer.service.ts:681-689 - Recovery uses getManagersForChat() without global fallback. Add fallback to global managers.","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:18.349454368+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:15:17.840912472+03:00","closed_at":"2026-01-14T16:15:17.840912472+03:00","close_reason":"Fixed: race condition, recovery fallback, logging, Redis policy"}
{"id":"buh-3wu","title":"DEV MODE: Frontend Config Module","description":"Create frontend/src/lib/config.ts with isDevMode and devMockUser exports.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:16.274647906+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.599872289+03:00","closed_at":"2026-01-30T17:34:34.599872289+03:00","close_reason":"Implemented"}
{"id":"buh-4ru","title":"P2: Add transaction boundaries for SLA breach handling","description":"sla-timer.worker.ts:77-101 - Multiple DB updates without transaction. Use prisma.$transaction for atomic operations.","status":"closed","priority":2,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:19.746350333+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:17:39.835558086+03:00","closed_at":"2026-01-14T16:17:39.835558086+03:00","close_reason":"Fixed: UI warning, transaction boundaries, manager validation"}
{"id":"buh-4v3","title":"Fix: SLA compliance excludes pending requests from denominator","description":"Code review finding: analytics.ts slaCompliance counts pending (unanswered, not-yet-breached) requests in totalRequests but they are not classified. This dilutes compliance %. Fix: exclude pending from denominator. File: backend/src/api/trpc/routers/analytics.ts lines 94-117","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:44:58.400806121+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:46:15.612035299+03:00","closed_at":"2026-02-12T13:46:15.612035299+03:00","close_reason":"Fixed: introduced classifiedRequests counter, pending requests excluded from compliance denominator","external_ref":"review-2"}
{"id":"buh-4y9","title":"Add distributed tracing (gh-77)","description":"Add OpenTelemetry instrumentation for message processing, SLA timers, DB queries, Telegram API calls.","status":"closed","priority":4,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:41.516824994+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:30:31.130951887+03:00","closed_at":"2026-02-14T20:30:31.130951887+03:00","close_reason":"Implemented: OpenTelemetry foundation with auto-instrumentation and manual spans, committed as 85f2b2e","external_ref":"gh-77"}
{"id":"buh-5h3","title":"DEV MODE: Context Auth Bypass","description":"Modify context.ts to return mock admin user when isDevMode is true. Use existing logger instead of console.log.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:09.081496197+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:36:16.01021549+03:00","closed_at":"2026-01-30T17:36:16.01021549+03:00","close_reason":"Implemented","dependencies":[{"issue_id":"buh-5h3","depends_on_id":"buh-0sl","type":"blocks","created_at":"2026-01-30T17:32:32.80521142+03:00","created_by":"Igor Maslennikov"}]}
{"id":"buh-5ph","title":"Security: Add auth for Grafana/Uptime Kuma (gh-65)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:22.976742079+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:36:34.634520236+03:00","closed_at":"2026-02-14T17:36:34.634520236+03:00","close_reason":"Added basic auth for Grafana/Uptime Kuma in nginx","external_ref":"gh-65"}
{"id":"buh-608","title":"Add enhanced request state machine (gh-69)","description":"Current states: pending/in_progress/answered/escalated. Need to add business states and enforce valid transitions. Add state transition validation in backend.","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:44.540160169+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T19:53:53.607198858+03:00","closed_at":"2026-02-14T19:53:53.607198858+03:00","close_reason":"Implemented enhanced request state machine (gh-69): added waiting_client, transferred, closed status values to RequestStatus enum, state transition validation in request.service.ts, updated all frontend components with new status configs and icons, migration 20260214020000","external_ref":"gh-69"}
{"id":"buh-65g","title":"Phase 2: Implement ErrorCaptureService with fingerprinting","description":"Create error-capture.service.ts with fingerprinting logic (MD5 hash normalization). Add DatabaseTransport to Winston logger for automatic error capture to DB.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:39.030251238+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:15:27.642114722+03:00","closed_at":"2026-01-16T14:15:27.642114722+03:00","close_reason":"ErrorCaptureService implemented with MD5 fingerprinting, normalization (UUIDs, timestamps, numbers), 24h deduplication window, Winston DatabaseTransport integration complete, type-check passed"}
{"id":"buh-6ku","title":"Fix: auth.me HTTP 500 in DEV_MODE — auto-upsert dev user if not found","description":"GitHub Issue #45. auth.me (auth.ts:70-81) throws 'User not found' when dev user UUID not in DB. Fix: if isDevMode and user not found, auto-upsert from DEV_MODE_USER context data. Files: backend/src/api/trpc/routers/auth.ts:65-81, backend/src/api/trpc/context.ts:47-52","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:51:15.863425623+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:57:17.595991019+03:00","closed_at":"2026-02-12T13:57:17.595991019+03:00","close_reason":"Auto-upsert dev user in auth.me when DEV_MODE and user not found","external_ref":"gh-45"}
{"id":"buh-6m0","title":"Fix SLA Timer ignores GlobalSettings working hours","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:12.052978806+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:09:12.751451128+03:00","closed_at":"2026-01-30T13:09:12.751451128+03:00","close_reason":"Fixed all bugs, type-check and build passed"}
{"id":"buh-6qm","title":"Fix: SLA save blocked when no managers configured (gh-38)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:42:46.650794234+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T11:44:38.274292578+03:00","closed_at":"2026-02-12T11:44:38.274292578+03:00","close_reason":"Fixed in commit f99b367","external_ref":"gh-38"}
{"id":"buh-703","title":"Add request thread tracking (gh-75)","description":"Add threadId/parentMessageId to ClientRequest. Detect threads via reply_to_message_id in Telegram. Group related messages.","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:39.555136726+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:20:51.083573522+03:00","closed_at":"2026-02-14T20:20:51.083573522+03:00","close_reason":"Implemented and committed as eddab36","external_ref":"gh-75"}
{"id":"buh-715","title":"DEV MODE: Seed Script Dev User","description":"Add DEV_ADMIN user with UUID aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa to seed.ts.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:14.901348277+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.626351653+03:00","closed_at":"2026-01-30T17:34:34.626351653+03:00","close_reason":"Implemented"}
{"id":"buh-78q","title":"Add logging when no managers configured for alerts","description":"В backend/src/queues/alert.worker.ts добавить logger.warn когда managerIds.length === 0","status":"closed","priority":3,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:05:44.706863307+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:15:17.847639593+03:00","closed_at":"2026-01-14T16:15:17.847639593+03:00","close_reason":"Fixed: race condition, recovery fallback, logging, Redis policy"}
{"id":"buh-7bc","title":"Fix: SLA breach notification leaks into client chat (notifyInChatOnBreach default)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T20:17:58.777150877+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T20:25:56.513413434+03:00","closed_at":"2026-02-11T20:25:56.513413434+03:00","close_reason":"Fixed: changed notifyInChatOnBreach @default(true)→@default(false) in schema, migration updates existing rows, registerChat default changed, frontend defaults fixed, JSDoc @test-only added to worker","external_ref":"gh-31"}
{"id":"buh-7ly","title":"Fix alert shows 0 minutes instead of actual time","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:07.407544902+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:05:11.112542925+03:00","closed_at":"2026-01-30T13:05:11.112542925+03:00","close_reason":"Fixed: use slaAlerts[0].minutesElapsed instead of slaWorkingMinutes"}
{"id":"buh-847","title":"Optimize dashboard query performance (gh-71)","description":"getDashboard runs 14+ separate DB queries. Add Redis caching layer with 30s TTL. Combine parallel queries where possible.","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:46.791166981+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:03:03.177696147+03:00","closed_at":"2026-02-14T20:03:03.177696147+03:00","close_reason":"Optimized getDashboard: replaced 14 sequential DB queries (7+7 day loops) with 2 batch queries + JS grouping; replaced N+1 accountant queries with single batch query + Map grouping; fixed status cast to include all 7 values","external_ref":"gh-71"}
{"id":"buh-87v","title":"Fix: AccountantSelect missing ARIA attributes (gh-59)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:15.586271286+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:33:42.992169106+03:00","closed_at":"2026-02-14T17:33:42.992169106+03:00","close_reason":"Fixed: ESLint errors resolved, type-check passed","external_ref":"gh-59"}
{"id":"buh-8hb","title":"Investigate data bug gh-50","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:07.325475627+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:45:28.232547413+03:00","closed_at":"2026-02-14T17:45:28.232547413+03:00","close_reason":"Fixed: SLA page dateRange now zeros hours on startDate and sets 23:59:59 on endDate for consistent day boundaries.","external_ref":"gh-50"}
{"id":"buh-8rf","title":"Security: Block /metrics endpoint from external access (gh-62)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:19.071611119+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:36:33.955974446+03:00","closed_at":"2026-02-14T17:36:33.955974446+03:00","close_reason":"Added IP check in Express + nginx deny block for /metrics","external_ref":"gh-62"}
{"id":"buh-8tp","title":"Add invite_link to Chat model and fetch on registration","description":"## Context\n- Chat model has no inviteLink field\n- t.me/c/ links only work for supergroups, not regular groups\n- Need to store invite_link in DB and use it for 'Open chat' button\n\n## Requirements\n1. Add inviteLink field to Chat model (prisma schema)\n2. Create migration\n3. On chat registration (/connect), fetch invite link via Telegram API:\n   - ctx.telegram.exportChatInviteLink(chatId) or createChatInviteLink\n4. Store invite_link in Chat record\n5. Update alert.keyboard.ts to use inviteLink if available, fallback to t.me/c/ for supergroups\n\n## Files to modify\n- backend/prisma/schema.prisma (add inviteLink String?)\n- backend/src/bot/handlers/invitation.handler.ts (fetch and store invite link)\n- backend/src/bot/keyboards/alert.keyboard.ts (use inviteLink in buildAlertKeyboard)\n\n## Telegram API\n- ctx.telegram.exportChatInviteLink(chatId) - returns primary invite link\n- ctx.telegram.createChatInviteLink(chatId) - creates new invite link","status":"closed","priority":1,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:40:41.02058533+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:49:01.6098149+03:00","closed_at":"2026-01-14T16:49:01.6098149+03:00","close_reason":"Implemented and deployed"}
{"id":"buh-9e6","title":"Security: Enforce notifyInChatOnBreach server-side (gh-64)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:21.874352632+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:36:34.408378469+03:00","closed_at":"2026-02-14T17:36:34.408378469+03:00","close_reason":"Added production guard blocking notifyInChatOnBreach=true","external_ref":"gh-64"}
{"id":"buh-9l4","title":"Schedule SLA timer reconciliation job (gh-67)","description":"Recovery function exists at timer.service.ts:605-763 but isn't scheduled. Create cron job in backend/src/jobs/ to run every 5 min, calling reconcileOrphanedTimers. Register in index.ts.","status":"closed","priority":1,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:41.556032571+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T19:41:53.360581122+03:00","closed_at":"2026-02-14T19:41:53.360581122+03:00","close_reason":"Implemented SLA reconciliation cron job (gh-67): created sla-reconciliation.job.ts with BullMQ worker running every 5 minutes, added queue to setup.ts, registered in index.ts startup","external_ref":"gh-67"}
{"id":"buh-9pw","title":"Fix: slaEnabled schema default contradicts actual behavior","description":"P2-1 from code review. Schema has @default(true) but chat-event.handler.ts always creates with slaEnabled:false. Misleading default causes confusion. Change schema default to false + migration.","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T21:22:21.050163524+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T21:24:08.08747908+03:00","closed_at":"2026-02-11T21:24:08.08747908+03:00","close_reason":"Fixed: changed slaEnabled @default(true)→@default(false) in schema to match actual handler behavior + migration"}
{"id":"buh-a7u","title":"Fix: slaEnabled form default should be false, not true","description":"ChatSettingsForm DEFAULT_VALUES has slaEnabled: true which contradicts DB default (false). One line fix.","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T12:29:51.475708112+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T12:38:13.468413417+03:00","closed_at":"2026-02-12T12:38:13.468413417+03:00","close_reason":"Changed slaEnabled default from true to false"}
{"id":"buh-anf","title":"Fix: Logo image console warning (gh-56)","status":"closed","priority":3,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:39:04.998265763+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:39:14.948170238+03:00","closed_at":"2026-02-14T17:39:14.948170238+03:00","close_reason":"Replaced Image width/height with fill prop in ThemeLogo","external_ref":"gh-56"}
{"id":"buh-b5a","title":"Investigate data bug gh-51","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:07.551008694+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:39:15.181382483+03:00","closed_at":"2026-02-14T17:39:15.181382483+03:00","close_reason":"Added no-data state to NPSWidget and TrendChart","external_ref":"gh-51"}
{"id":"buh-bct","title":"Add request history audit trail (gh-70)","description":"Create RequestHistory table to track all status changes with who/when/why. Add trigger or service-level logging on ClientRequest status updates.","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:45.592091987+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T19:57:46.445829614+03:00","closed_at":"2026-02-14T19:57:46.445829614+03:00","close_reason":"Implemented request history audit trail (gh-70): RequestHistory model, automatic status change logging in updateRequestStatus and markRequestAsAnswered, tRPC getHistory endpoint, migration 20260214030000","external_ref":"gh-70"}
{"id":"buh-bjw","title":"Add FAQ entry for Privacy Mode to docs/user-guide/faq-users.md","status":"closed","priority":1,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:18:06.298650541+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:19:03.035739+03:00","closed_at":"2026-01-30T17:19:03.035739+03:00","close_reason":"Added FAQ entry for Privacy Mode"}
{"id":"buh-brr","title":"Phase 5: Create frontend logs components (Table, Header, Filters, StatusBadge)","description":"Create LogsTable.tsx, LogsHeader.tsx, LogsFilters.tsx, StatusBadge.tsx components. Follow existing patterns from RequestsTable.tsx.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:44.188449266+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:29:56.44419224+03:00","closed_at":"2026-01-16T14:29:56.44419224+03:00","close_reason":"Frontend logs UI complete: 6 files created (4 components + 2 pages), type-check passed, follows BuhBot design patterns, integrated with tRPC router"}
{"id":"buh-chq","title":"HOTFIX: Configure SLA settings - set manager_telegram_ids and sla_threshold=15","description":"Root cause: manager_telegram_ids was empty [], sla_threshold was 60 instead of 15. Fixed via SQL: UPDATE global_settings SET global_manager_ids=['166848328'], default_sla_threshold=15; UPDATE chats SET sla_threshold_minutes=15, manager_telegram_ids=['166848328'] WHERE sla_enabled=true","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T15:59:40.995281559+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T15:59:47.159179014+03:00","closed_at":"2026-01-14T15:59:47.159179014+03:00","close_reason":"Fixed: Updated global_settings and all 4 chats with sla_enabled=true. SLA threshold set to 15 min, manager_telegram_ids set to [166848328]"}
{"id":"buh-cp9","title":"Add VIP client handling (gh-76)","description":"Add clientTier enum to Chat model. Tier-based SLA thresholds. Priority routing for VIP requests.","status":"closed","priority":3,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:40.534120637+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:26:00.949928474+03:00","closed_at":"2026-02-14T20:26:00.949928474+03:00","close_reason":"Implemented: ClientTier enum + tier-based SLA thresholds, committed as b201b9b","external_ref":"gh-76"}
{"id":"buh-csw","title":"Fix: SLA stats math 0+0≠1 + violations chart fractional Y-axis","description":"GitHub Issue #42. Root Cause A: analytics.slaCompliance counts answeredWithinSLA/breachedSLA only for requests with responseTimeMinutes!==null. Requests without response but slaBreached=true are NOT counted as breached. Fix: count null-response requests with slaBreached=true as breached. Root Cause B: YAxis in violations/page.tsx has no allowDecimals=false. Files: backend/src/api/trpc/routers/analytics.ts:98-108, frontend/src/app/violations/page.tsx:295-298","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:25:24.775042532+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:29:27.067069673+03:00","closed_at":"2026-02-12T13:29:27.067069673+03:00","close_reason":"Fixed: 1) Unanswered slaBreached requests counted as breached in analytics.slaCompliance, 2) allowDecimals=false on violations chart YAxis","external_ref":"gh-42"}
{"id":"buh-cz5","title":"Fix: analytics.ts uses wrong SLA field (slaResponseMinutes instead of slaThresholdMinutes)","description":"P0-2 from code review. analytics.ts lines 73,103,284,310,940,974 use slaResponseMinutes. All SLA compliance metrics, dashboard KPIs, exports are calculated against the wrong threshold. Must replace all 6 occurrences with slaThresholdMinutes.","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T21:22:19.324656783+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T21:24:07.768016037+03:00","closed_at":"2026-02-11T21:24:07.768016037+03:00","close_reason":"Fixed: replaced all 8 occurrences of slaResponseMinutes→slaThresholdMinutes in analytics.ts (select blocks + calculations + exports)"}
{"id":"buh-d6f","title":"Fix: Dashboard activeAlertsCount query uses wrong filter — align with getActiveAlertCount","description":"Code review: getDashboard activeAlerts query (analytics.ts:460-464) uses deliveryStatus in ['pending','sent'] AND acknowledgedAt=null. But getActiveAlertCount (alert.ts:659) uses resolvedAction=null. Different conditions produce different counts, causing widget mismatch. Fix: align getDashboard to use resolvedAction=null.","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:51:14.769795233+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:57:17.848207296+03:00","closed_at":"2026-02-12T13:57:17.848207296+03:00","close_reason":"Aligned activeAlertsCount query with resolvedAction: null","external_ref":"review-alerts-query"}
{"id":"buh-dex","title":"P1: Validate manager lists before alert creation","description":"alert.service.ts:133-164 - Alert created BEFORE checking for managers. Move validation before creation, add global fallback.","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:17.240767346+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:17:39.850309561+03:00","closed_at":"2026-01-14T16:17:39.850309561+03:00","close_reason":"Fixed: UI warning, transaction boundaries, manager validation"}
{"id":"buh-dg8","title":"Fix: Analytics page 'Action' label in English (gh-52)","status":"closed","priority":3,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:07.717110474+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:33:42.983140741+03:00","closed_at":"2026-02-14T17:33:42.983140741+03:00","close_reason":"Fixed: ESLint errors resolved, type-check passed","external_ref":"gh-52"}
{"id":"buh-djk","title":"Fix: TypeScript any in test files (gh-58)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:11.486262875+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:33:42.990251993+03:00","closed_at":"2026-02-14T17:33:42.990251993+03:00","close_reason":"Fixed: ESLint errors resolved, type-check passed","external_ref":"gh-58"}
{"id":"buh-dvv","title":"DEV MODE: Prisma Connection Improvements","description":"Add longer connection timeout for development mode (15s vs 5s). Ensure env.ts is loaded first.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:12.2731938+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.619306466+03:00","closed_at":"2026-01-30T17:34:34.619306466+03:00","close_reason":"Implemented"}
{"id":"buh-e38","title":"Add regression tests T1-T3 from code review","description":"T1: test analytics uses slaThresholdMinutes. T2: test migration handler upsert no duplicates. T3: test notifyInChatOnBreach default=false","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T21:40:29.577625207+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T21:45:50.40670164+03:00","closed_at":"2026-02-11T21:45:50.40670164+03:00","close_reason":"Done: 6 regression tests added (T1-T3), all passing"}
{"id":"buh-e40","title":"Fix: notifyInChatOnBreach toggle not persisting (gh-37)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:42:44.199884989+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T11:44:38.267574289+03:00","closed_at":"2026-02-12T11:44:38.267574289+03:00","close_reason":"Fixed in commit f99b367","external_ref":"gh-37"}
{"id":"buh-e5z","title":"Security: Restrict PII in alerts API (gh-63)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:20.582051599+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:36:34.181116718+03:00","closed_at":"2026-02-14T17:36:34.181116718+03:00","close_reason":"Changed listUnacknowledged from authedProcedure to managerProcedure","external_ref":"gh-63"}
{"id":"buh-e92","title":"DEV MODE: Frontend LoginForm","description":"Add DEV MODE banner and auth bypass to LoginForm.tsx.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:19.606382593+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:36:16.031802071+03:00","closed_at":"2026-01-30T17:36:16.031802071+03:00","close_reason":"Implemented","dependencies":[{"issue_id":"buh-e92","depends_on_id":"buh-3wu","type":"blocks","created_at":"2026-01-30T17:32:33.60739866+03:00","created_by":"Igor Maslennikov"}]}
{"id":"buh-eg8","title":"Fix: SLA breach alert silently fails when no managers configured","description":"Когда managerTelegramIds и globalManagerIds пусты, sla-timer.worker.ts создаёт alert со статусом failed и logger.error — никто не узнаёт о breach. Warning есть в ChatSettingsForm, но НЕТ в GeneralSettingsForm (предыдущий фикс buh-w1w был неполным). Фикс: добавить warning banner в GeneralSettingsForm","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T20:18:23.513288171+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T20:25:57.5010709+03:00","closed_at":"2026-02-11T20:25:57.5010709+03:00","close_reason":"Fixed: added warning banner in GeneralSettingsForm when globalManagerIds is empty","external_ref":"gh-34"}
{"id":"buh-fb5","title":"Complete accountant field migration (gh-72)","description":"Remove legacy accountantUsername field from Chat model. Migrate data to accountantUsernames array. Drop column via migration. Clean up all references.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:35.703084768+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:14:06.547685783+03:00","closed_at":"2026-02-14T20:14:06.547685783+03:00","close_reason":"Removed legacy accountantUsername from DB schema, migrated data to array, updated all handlers/routers/tests","external_ref":"gh-72"}
{"id":"buh-fj5","title":"Unify configuration management (gh-74)","description":"Create unified ConfigService with precedence hierarchy: chat-level \u003e global \u003e env \u003e default. Consolidate settings.","status":"closed","priority":3,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:38.340561032+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:12:52.090656252+03:00","closed_at":"2026-02-14T20:12:52.090656252+03:00","close_reason":"Created ConfigService with 5-min TTL cache for GlobalSettings. Integrated with settings router (cache invalidation on update) and escalation service (replaced 2 direct DB queries with cached getters). 20+ call sites can now be gradually migrated.","external_ref":"gh-74"}
{"id":"buh-fkt","title":"Fix: Frontend displays wrong SLA field (slaResponseMinutes vs slaThresholdMinutes)","description":"Frontend показывает slaResponseMinutes, а backend использует slaThresholdMinutes для breach detection. tRPC router никогда не возвращает slaThresholdMinutes. Фикс: заменить slaResponseMinutes→slaThresholdMinutes в tRPC output schemas, select блоках, и всех frontend компонентах","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T20:18:19.01999254+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T20:25:57.255599877+03:00","closed_at":"2026-02-11T20:25:57.255599877+03:00","close_reason":"Fixed: replaced slaResponseMinutes→slaThresholdMinutes in tRPC output schemas, Prisma select blocks, all frontend components","external_ref":"gh-33"}
{"id":"buh-g4l","title":"Implement request deduplication (gh-66)","description":"Add dedup logic to message.handler.ts: hash message text, check for similar hash in same chat within 5-min window. Add contentHash/relatedRequestId fields to ClientRequest. Migration needed.","status":"closed","priority":1,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:39.423153368+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T19:44:24.740427926+03:00","closed_at":"2026-02-14T19:44:24.740427926+03:00","close_reason":"Implemented request deduplication (gh-66): added contentHash + relatedRequestId to ClientRequest schema, SHA-256 hash of normalized text, 5-min window dedup check in message.handler.ts, migration 20260214000000","external_ref":"gh-66"}
{"id":"buh-g7p","title":"Fix: Duplicate chat entries during group-to-supergroup migration","description":"chat-event.handler.ts:169 использует prisma.chat.create() вместо upsert(). При миграции group→supergroup my_chat_member создаёт запись первым, затем migrate_to_chat_id падает с Unique constraint. Фикс: заменить create на upsert, пометить старый чат [MIGRATED]","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T20:18:16.242065542+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T20:25:57.010225155+03:00","closed_at":"2026-02-11T20:25:57.010225155+03:00","close_reason":"Fixed: replaced create() with upsert() in migrate_to_chat_id handler, old chat marked [MIGRATED]","external_ref":"gh-32"}
{"id":"buh-ga4","title":"Add classifier feedback loop (gh-73)","description":"Add ClassificationCorrection model, track manual corrections, add correction endpoint to requests router","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T20:04:37.299097959+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T20:20:51.079048409+03:00","closed_at":"2026-02-14T20:20:51.079048409+03:00","close_reason":"Implemented and committed as eddab36","external_ref":"gh-73"}
{"id":"buh-gma","title":"Code review: SLA/alert system","description":"Провести код-ревью SLA/alert системы: alert.worker.ts, sla-timer.worker.ts, message.handler.ts. Проверить на баги, best practices, улучшения.","status":"closed","priority":2,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:07:58.777748986+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:17:39.857514217+03:00","closed_at":"2026-01-14T16:17:39.857514217+03:00","close_reason":"Fixed: UI warning, transaction boundaries, manager validation"}
{"id":"buh-gn4","title":"Fix ClassifierService ignores aiConfidenceThreshold","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:13.261336077+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:09:12.75916173+03:00","closed_at":"2026-01-30T13:09:12.75916173+03:00","close_reason":"Fixed all bugs, type-check and build passed"}
{"id":"buh-gvw","title":"DEV MODE: docker-compose.local.yml","description":"Create infrastructure/docker-compose.local.yml with postgres and redis services for local development.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:21.922352333+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.632638781+03:00","closed_at":"2026-01-30T17:34:34.632638781+03:00","close_reason":"Implemented"}
{"id":"buh-hg4","title":"Fix: Admin footer version out of sync with Release Please (gh-39)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:42:45.299098505+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T11:44:38.27225796+03:00","closed_at":"2026-02-12T11:44:38.27225796+03:00","close_reason":"Fixed in commit f99b367","external_ref":"gh-39"}
{"id":"buh-hsv","title":"Replace native date input with shadcn/ui DatePicker in HolidayCalendar","description":"Code review: lang=ru on \u003cinput type=date\u003e is browser-dependent. Replace with shadcn/ui Calendar/DatePicker for consistent dd.mm.yyyy across browsers. File: frontend/src/components/settings/HolidayCalendar.tsx. No existing calendar/datepicker UI component found in project — need to install shadcn calendar first.","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:51:09.693186576+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:57:18.091906264+03:00","closed_at":"2026-02-12T13:57:18.091906264+03:00","close_reason":"Replaced native date input with shadcn/ui DatePicker with ru locale","external_ref":"review-datepicker"}
{"id":"buh-hzd","title":"P0: Fix race condition in alert delivery status updates","description":"alert.worker.ts:203-223 - Two separate DB updates for same alert. If crash between updates, alert stuck in 'sent' state. Fix: collect all message IDs, single atomic update at end.","status":"closed","priority":0,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:15.093742536+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:15:17.833742308+03:00","closed_at":"2026-01-14T16:15:17.833742308+03:00","close_reason":"Fixed: race condition, recovery fallback, logging, Redis policy"}
{"id":"buh-i4s","title":"Fix: Minor UI/UX — dashboard alert count, date picker locale, table truncation, TG widget","description":"GitHub Issue #43. 4 sub-issues: A) Dashboard 'Активные алерты' shows 0 but lists 1 alert — count uses activeAlertsCount (resolvedAction=null) but list shows breached requests. B) Holiday date picker shows mm/dd/yyyy instead of dd.mm.yyyy. C) /alerts and /logs table ДЕЙСТВИЯ column truncated. D) Settings Telegram widget shows 'Bot domain invalid' in dev mode — should be hidden or show explanation. Files: frontend/src/app/dashboard/dashboard-content.tsx, frontend/src/app/settings/**","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:25:29.618182038+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:29:27.294088129+03:00","closed_at":"2026-02-12T13:29:27.294088129+03:00","close_reason":"Fixed: A) Dashboard alert count uses Math.max(activeAlertsCount, breachedRequests.length), B) Date input lang=ru + placeholder, C) min-w-[120px] whitespace-nowrap on ДЕЙСТВИЯ columns, D) isDevMode check hides TG widget","external_ref":"gh-43"}
{"id":"buh-jbn","title":"Fix mock paths in response.handler.test.ts","description":"vi.mock() uses alias paths (@/lib/prisma.js) but handler imports use relative paths (../../lib/prisma.js). Mocks don't intercept.","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-04T14:50:41.919596456+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-04T14:52:19.804143723+03:00","closed_at":"2026-02-04T14:52:19.804143723+03:00","close_reason":"Fixed: changed vi.mock() alias paths to relative paths matching handler imports. 34/34 tests pass, 83/83 full suite.","external_ref":"gh-29"}
{"id":"buh-jk2","title":"Fix: Landing footer shows 2025 AIDevTeam (gh-53)","status":"closed","priority":3,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:10.012399379+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:33:42.988383409+03:00","closed_at":"2026-02-14T17:33:42.988383409+03:00","close_reason":"Fixed: ESLint errors resolved, type-check passed","external_ref":"gh-53"}
{"id":"buh-jo3","title":"Add warning in UI when manager_telegram_ids is empty","description":"UI позволяет сохранять чат без manager_telegram_ids, что делает уведомления невозможными. Добавить warning в frontend/src/app/chats/[id]/page.tsx","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:05:43.671455481+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:17:39.827969707+03:00","closed_at":"2026-01-14T16:17:39.827969707+03:00","close_reason":"Fixed: UI warning, transaction boundaries, manager validation"}
{"id":"buh-k5a","title":"Notify all accountants from accountantUsernames array","description":"## Context\n- Currently only assignedAccountant receives DM notification\n- accountantUsernames array may contain multiple accountants\n- Need to notify ALL accountants, not just the assigned one\n\n## Requirements\n1. In alert-callback.handler.ts, collect all accountant telegram_ids:\n   - assignedAccountant.telegramId (primary)\n   - For each username in accountantUsernames, lookup in users table by telegramUsername\n2. Send notification to ALL found telegram_ids (not just one)\n3. Fallback to group mention if no telegram_ids found\n\n## Files to modify\n- backend/src/bot/handlers/alert-callback.handler.ts\n\n## DB Query needed\nSELECT telegram_id FROM users WHERE telegram_username IN (accountantUsernames)\n\n## Edge cases\n- Duplicate: assignedAccountant might also be in accountantUsernames - dedupe\n- Not found: username in array but no matching user - skip silently\n- All fail: fallback to group mention","status":"closed","priority":1,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:40:42.051395191+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:49:01.615871195+03:00","closed_at":"2026-01-14T16:49:01.615871195+03:00","close_reason":"Implemented and deployed"}
{"id":"buh-k9r","title":"DEV MODE: Supabase Client Non-Nullable","description":"Modify supabase.ts to use placeholder values in DEV MODE instead of throwing errors. Keep client non-nullable.","status":"closed","priority":1,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:10.070782155+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:36:16.016877487+03:00","closed_at":"2026-01-30T17:36:16.016877487+03:00","close_reason":"Implemented","dependencies":[{"issue_id":"buh-k9r","depends_on_id":"buh-0sl","type":"blocks","created_at":"2026-01-30T17:32:33.04821059+03:00","created_by":"Igor Maslennikov"}]}
{"id":"buh-kjn","title":"Security: Add CORS middleware to Express (gh-61)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:17.817703666+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:36:33.715760312+03:00","closed_at":"2026-02-14T17:36:33.715760312+03:00","close_reason":"Added cors middleware with origin restrictions","external_ref":"gh-61"}
{"id":"buh-kmk","title":"Investigate data bug gh-48","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:06.86622685+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:52:02.434920017+03:00","closed_at":"2026-02-14T17:52:02.434920017+03:00","close_reason":"Fixed: Dashboard alertsData now uses only activeAlertsCount from SlaAlert table, consistent with Alerts page. Removed Math.max fabrication from breached requests.","external_ref":"gh-48"}
{"id":"buh-l8q","title":"Fix BigInt serialization in logger","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:05.524518456+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:04:56.454490145+03:00","closed_at":"2026-01-30T13:04:56.454490145+03:00","close_reason":"Fixed BigInt serialization in logger"}
{"id":"buh-mfp","title":"Chore: document slaResponseMinutes dual-field sync in settings.ts","description":"P1-1 from code review. settings.ts line 668 updates both slaThresholdMinutes and slaResponseMinutes without explanation. Add comment documenting why both fields are kept in sync (backward compat until deprecation).","status":"closed","priority":3,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T21:22:22.980762853+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T21:24:08.390771586+03:00","closed_at":"2026-02-11T21:24:08.390771586+03:00","close_reason":"Fixed: added comment to settings.ts explaining legacy field sync"}
{"id":"buh-mgs","title":"Phase 4: Create frontend logs pages (main + detail)","description":"Create /logs/page.tsx (main list page) and /logs/[id]/page.tsx (detail page). Use AdminLayout, tRPC queries, and table components.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:42.628678792+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:29:56.438322317+03:00","closed_at":"2026-01-16T14:29:56.438322317+03:00","close_reason":"Frontend logs UI complete: 6 files created (4 components + 2 pages), type-check passed, follows BuhBot design patterns, integrated with tRPC router"}
{"id":"buh-mpj","title":"Fix notifyInChatOnBreach not set on chat creation (gh-17)","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T16:14:50.186535448+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T16:14:56.722879823+03:00","closed_at":"2026-01-30T16:14:56.722879823+03:00","close_reason":"Fixed: Added notifyInChatOnBreach: true to registerChat create block, migration to update existing chats, tests added","external_ref":"gh-17"}
{"id":"buh-mym","title":"Fix hardcoded min(15) in SLA validation","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:14.308506073+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:09:12.767044082+03:00","closed_at":"2026-01-30T13:09:12.767044082+03:00","close_reason":"Fixed all bugs, type-check and build passed"}
{"id":"buh-n4m","title":"Add backend integration tests for chats.update mutation","description":"Code review found zero test coverage for chats.update mutation. Need tests for: 1) SLA enable transition with/without managers, 2) notifyInChatOnBreach persistence, 3) partial updates with undefined fields, 4) SLA already enabled with removed managers. File: backend/src/api/trpc/routers/__tests__/chats.test.ts","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:51:00.487394546+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T11:54:27.565252436+03:00","closed_at":"2026-02-12T11:54:27.565252436+03:00","close_reason":"Added 8 new tests for chats.update mutation"}
{"id":"buh-nao","title":"DEV MODE: Frontend .env.example Update","description":"Add NEXT_PUBLIC_DEV_MODE entry to frontend/.env.example.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:20.976682957+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.612648825+03:00","closed_at":"2026-01-30T17:34:34.612648825+03:00","close_reason":"Implemented"}
{"id":"buh-nhg","title":"Update README.md prerequisites with Privacy Mode warning","status":"closed","priority":1,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:18:07.722187876+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:19:20.227839396+03:00","closed_at":"2026-01-30T17:19:20.227839396+03:00","close_reason":"Updated README prerequisites with Privacy Mode warning"}
{"id":"buh-oyj","title":"Phase 1: Add ErrorLog Prisma model and migration","description":"Add ErrorLog model with ErrorStatus enum to Prisma schema. Include RLS policies for admin-only access. Generate and apply migration.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:36.343649533+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:04:24.438053488+03:00","closed_at":"2026-01-16T14:04:24.438053488+03:00","close_reason":"ErrorLog Prisma model added with ErrorStatus enum, migration 20260116000000_add_error_logs created and applied, RLS policies implemented, User model updated with assignedErrors relation"}
{"id":"buh-phi","title":"Fix: Add logger.warn when SLA enabled without managers + defensive ?? false for notifyInChatOnBreach","description":"Code review found: 1) SLA validation skips manager check when SLA already enabled. Add logger.warn for monitoring. 2) notifyInChatOnBreach should use ?? false as defensive fallback. Files: backend/src/api/trpc/routers/chats.ts, frontend/src/components/chats/ChatSettingsForm.tsx","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T11:50:59.005912641+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T11:54:26.900795217+03:00","closed_at":"2026-02-12T11:54:26.900795217+03:00","close_reason":"Added logger.warn for SLA without managers + ?? false fallback for notifyInChatOnBreach"}
{"id":"buh-qgo","title":"Fix Redis eviction policy for BullMQ","description":"Redis настроен с allkeys-lru, должен быть noeviction для BullMQ. Файл: infrastructure/docker-compose.yml","status":"closed","priority":3,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:05:45.830142822+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:15:17.854116079+03:00","closed_at":"2026-01-14T16:15:17.854116079+03:00","close_reason":"Fixed: race condition, recovery fallback, logging, Redis policy"}
{"id":"buh-qtj","title":"Investigate data bug gh-55","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:08.004703656+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:52:04.546672881+03:00","closed_at":"2026-02-14T17:52:04.546672881+03:00","close_reason":"Fixed: Message handler now auto-registers unregistered chats via upsert (slaEnabled=false by default). Ensures chats appear in admin panel even if my_chat_member event was missed.","external_ref":"gh-55"}
{"id":"buh-r5j","title":"Fix Release Please workflow (gh-26, gh-27, gh-28)","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-04T12:45:10.005073347+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-04T12:52:26.903954443+03:00","closed_at":"2026-02-04T12:52:26.903954443+03:00","close_reason":"Fixed: enabled GH Actions PR permission, synced local main, verified workflow (run #21643796447 succeeded, PR #30 created), closed issues #26, #27, #28","external_ref":"gh-26"}
{"id":"buh-r97","title":"Global SLA threshold should update existing chats (gh-16)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T16:14:51.637753302+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T16:14:58.480402397+03:00","closed_at":"2026-01-30T16:14:58.480402397+03:00","close_reason":"Fixed: updateSlaThresholds now updates all existing chats via chat.updateMany(), returns updatedChats count, tests added","external_ref":"gh-16"}
{"id":"buh-rps","title":"Fix: Resolve alert HTTP 500 — FK violation + unsafe messageText","description":"GitHub Issue #44. Root Cause: resolveAlertService sets acknowledgedBy=userId (FK to User). In DEV_MODE userId='aaaaaaaa-...' may not exist in DB → P2003. Also: messageText.substring(0,200) crashes on null. Also: cancelEscalation failure blocks resolve. Files: backend/src/api/trpc/routers/alert.ts:220,295-353, backend/src/services/alerts/alert.service.ts:225-232, backend/src/services/alerts/escalation.service.ts","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:25:23.400886101+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:29:26.839189814+03:00","closed_at":"2026-02-12T13:29:26.839189814+03:00","close_reason":"Fixed: 1) Safe messageText access with ?? '', 2) cancelEscalation wrapped in try/catch (non-blocking), 3) User existence check before FK write","external_ref":"gh-44"}
{"id":"buh-uas","title":"Investigate data bug gh-54","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:07.779213939+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:52:03.677068402+03:00","closed_at":"2026-02-14T17:52:03.677068402+03:00","close_reason":"Fixed: Initialize isAuthorized from isDevMode to prevent false→true flicker on navigation. Added staleTime=25s to alert count query.","external_ref":"gh-54"}
{"id":"buh-uo4","title":"Enhance accountant verification by Telegram ID (gh-68)","description":"Check 3 already verifies telegramId for single assignedAccountant. Problem: accountantUsernames array uses username-only matching. Need to add telegramId-based matching for multi-accountant chats. Consider adding accountant_telegram_ids BigInt[] field to Chat model.","status":"closed","priority":1,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T19:36:43.32381666+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T19:48:29.784599635+03:00","closed_at":"2026-02-14T19:48:29.784599635+03:00","close_reason":"Enhanced accountant verification (gh-68): added accountantTelegramIds BigInt[] to Chat model, reordered checks to prioritize ID-based over username-based, auto-populate IDs in update mutation, updated tests","external_ref":"gh-68"}
{"id":"buh-v56","title":"Investigate data bug gh-47","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:06.633010046+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:45:25.973065985+03:00","closed_at":"2026-02-14T17:45:25.973065985+03:00","close_reason":"Fixed: compliance calc now uses classified-only denominator (answered+breached), matching slaCompliance query. Fixed in analytics.ts getDashboard and accountantStats.","external_ref":"gh-47"}
{"id":"buh-v7i","title":"Investigate data bug gh-49","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:37:07.097849694+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:41:42.405928984+03:00","closed_at":"2026-02-14T17:41:42.405928984+03:00","close_reason":"Unified request status types: replaced resolved/violated with answered/escalated from Prisma schema across all components","external_ref":"gh-49"}
{"id":"buh-vn3","title":"Test Beads integration","description":"Test task to verify Beads is working correctly","status":"closed","priority":4,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T13:40:24.325176345+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T13:40:32.649950416+03:00","closed_at":"2026-01-14T13:40:32.649950416+03:00","close_reason":"Test completed - Beads integration verified"}
{"id":"buh-w0j","title":"Fix: useMemo dependency warning ChatsListContent (gh-60)","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-14T17:31:16.655837038+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-14T17:33:42.994032162+03:00","closed_at":"2026-02-14T17:33:42.994032162+03:00","close_reason":"Fixed: ESLint errors resolved, type-check passed","external_ref":"gh-60"}
{"id":"buh-w1w","title":"P1: Add global manager fallback when chat managers empty","description":"sla-timer.worker.ts:122-143 - When no managers configured, system logs warning but takes no action. Add fallback to global_settings.globalManagerIds","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:16.252217505+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-14T16:17:39.843444149+03:00","closed_at":"2026-01-14T16:17:39.843444149+03:00","close_reason":"Fixed: UI warning, transaction boundaries, manager validation"}
{"id":"buh-wv4","title":"DEV MODE: Backend .env.example Update","description":"Add DEV_MODE and DEV_USER_EMAIL entries to backend/.env.example with comments.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:32:13.541779476+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:34:34.606225489+03:00","closed_at":"2026-01-30T17:34:34.606225489+03:00","close_reason":"Implemented"}
{"id":"buh-xch","title":"P2: Centralize queue configuration in environment variables","description":"Hardcoded values in alert.worker.ts, sla-timer.worker.ts, setup.ts. Create config/queue.config.ts with env vars.","status":"closed","priority":2,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-14T16:13:20.880993331+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:25:35.574092798+03:00","closed_at":"2026-01-30T13:25:35.574092798+03:00","close_reason":"Implemented centralized queue configuration"}
{"id":"buh-xcw","title":"Remove deprecated slaResponseMinutes field entirely","description":"P0-1 from code review. Remove slaResponseMinutes from schema, drop column via migration, remove all 19 code/test references. slaThresholdMinutes is the canonical field.","status":"closed","priority":1,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-11T21:40:29.332366305+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-11T21:45:50.141995699+03:00","closed_at":"2026-02-11T21:45:50.141995699+03:00","close_reason":"Done: removed slaResponseMinutes field entirely — schema, migration, 19 code/test refs"}
{"id":"buh-xla","title":"Phase 6: Add logs navigation item to AdminLayout","description":"Add 'System Logs' navigation item to AdminLayout.tsx navigation items array.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:46.196945383+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:32:05.553175641+03:00","closed_at":"2026-01-16T14:32:05.553175641+03:00","close_reason":"Navigation item added to AdminLayout: 'Системные логи' with FileWarning icon, placed between Users and Settings"}
{"id":"buh-xox","title":"Add Privacy Mode troubleshooting section to docs/infrastructure/troubleshooting.md","status":"closed","priority":1,"issue_type":"chore","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T17:18:05.238022971+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T17:18:42.950346573+03:00","closed_at":"2026-01-30T17:18:42.950346573+03:00","close_reason":"Added Privacy Mode troubleshooting section"}
{"id":"buh-y2i","title":"Fix: Multiple admin pages render blank on client-side navigation (hydration/CSS race)","description":"GitHub Issue #41. Affected: /reports, /feedback, /help stay blank. /settings blank until reload. /dashboard,/analytics,/chats flash briefly. DOM shows content but not visible. Probable CSS hydration race: CSS variables not applied, or AdminLayout returns null while isAuthorized=false (line 512). /reports uses framer-motion which may conflict with SSR. Files: frontend/src/components/layout/AdminLayout.tsx:447-514, frontend/src/app/reports/page.tsx (framer-motion), frontend/src/styles/design-system.css, frontend/src/app/globals.css","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:25:33.244967003+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:34:16.772180254+03:00","closed_at":"2026-02-12T13:34:16.772180254+03:00","close_reason":"Fixed: Removed buh-stagger class from AdminLayout content wrapper. Root cause: CSS animation opacity:0 on children overrode framer-motion inline styles, trapping pages at invisible state.","external_ref":"gh-41"}
{"id":"buh-ype","title":"Fix: console.warn → logger.warn + add warning when user not found in alert resolve","description":"Code review finding: alert.ts line 325 uses console.warn instead of structured logger.warn. Also add logger.warn when authenticated user not found in DB (line 332-338). Files: backend/src/api/trpc/routers/alert.ts","status":"closed","priority":2,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-02-12T13:44:56.033586477+03:00","created_by":"Igor Maslennikov","updated_at":"2026-02-12T13:46:15.36993179+03:00","closed_at":"2026-02-12T13:46:15.36993179+03:00","close_reason":"Fixed: replaced console.warn with logger.warn, added structured warning when user not found in DB","external_ref":"review-1"}
{"id":"buh-z2x","title":"Add backend validation for manager configuration","status":"closed","priority":2,"issue_type":"feature","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:44:37.247639694+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:47:56.274381606+03:00","closed_at":"2026-01-30T13:47:56.274381606+03:00","close_reason":"Added backend validation for SLA enable without managers + startup warning","external_ref":"gh-13"}
{"id":"buh-zdc","title":"Phase 3: Create tRPC logs router with all procedures","description":"Create logs.ts router with procedures: list, listGrouped, getById, updateStatus, bulkUpdateStatus, delete. Register in appRouter.","status":"closed","priority":2,"issue_type":"task","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-16T13:57:40.588733612+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-16T14:20:45.825923039+03:00","closed_at":"2026-01-16T14:20:45.825923039+03:00","close_reason":"tRPC logs router implemented with 6 procedures: list (cursor pagination), listGrouped (fingerprint grouping), getById, updateStatus, bulkUpdateStatus, delete. All admin-guarded mutations, type-check passed"}
{"id":"buh-zi0","title":"Fix new chat ignores defaultSlaThreshold","status":"closed","priority":1,"issue_type":"bug","owner":"maslennikov.ig@gmail.com","created_at":"2026-01-30T13:04:08.313784117+03:00","created_by":"Igor Maslennikov","updated_at":"2026-01-30T13:09:12.744294903+03:00","closed_at":"2026-01-30T13:09:12.744294903+03:00","close_reason":"Fixed all bugs, type-check and build passed"}
