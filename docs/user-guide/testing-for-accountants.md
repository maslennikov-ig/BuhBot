# Инструкция для тестирования: Назначение бухгалтеров по @username

> **Версия:** 0.9.10
> **Дата:** 20 декабря 2025
> **Для кого:** Бухгалтеры-тестеры

---

## Что нового?

Теперь можно указывать ответственных бухгалтеров прямо по их Telegram @username, без регистрации в системе. Это позволяет:

- Добавить нескольких бухгалтеров на один чат
- Быстро настроить, кто отвечает за клиента
- Автоматически останавливать SLA-таймер при ответе бухгалтера

---

## Тест 1: Добавление @username в настройках чата

### Шаги:

1. Откройте веб-панель BuhBot: **https://buhbot.aidevteam.ru**
2. Войдите в систему
3. Перейдите в раздел **«Чаты»** в левом меню
4. Выберите любой чат из списка
5. Нажмите на иконку **шестерёнки** (Настройки чата)
6. Найдите поле **«Бухгалтеры (@username)»**

### Что проверить:

| # | Действие | Ожидаемый результат | ✓/✗ |
|---|----------|---------------------|-----|
| 1 | Введите свой @username (без @) и нажмите Enter | Username появился как «тег» с иконкой | ☐ |
| 2 | Введите @username с @ в начале | @ убралось автоматически, тег добавлен | ☐ |
| 3 | Попробуйте добавить тот же username ещё раз | Появилось сообщение «Этот username уже добавлен» | ☐ |
| 4 | Введите слишком короткий username (менее 5 букв) | Появилась ошибка валидации | ☐ |
| 5 | Нажмите **X** на любом теге | Тег удалился | ☐ |
| 6 | Добавьте 2-3 username и нажмите **«Сохранить»** | Появилось сообщение «Настройки успешно сохранены» | ☐ |
| 7 | Обновите страницу (F5) | Добавленные username остались на месте | ☐ |

---

## Тест 2: Распознавание бухгалтера в Telegram

### Подготовка:

1. Убедитесь, что ваш @username добавлен в настройках чата (см. Тест 1)
2. Откройте Telegram-чат с клиентом, где добавлен бот

### Шаги:

1. Попросите коллегу (или с другого аккаунта) написать сообщение в чат от имени клиента
2. Подождите несколько секунд — должна создаться заявка
3. Ответьте на это сообщение от **своего** аккаунта (чей @username указан в настройках)

### Что проверить:

| # | Проверка | Ожидаемый результат | ✓/✗ |
|---|----------|---------------------|-----|
| 1 | После сообщения клиента | В веб-панели появилась новая заявка со статусом «Ожидает» | ☐ |
| 2 | После вашего ответа | Статус заявки изменился на «Отвечено» | ☐ |
| 3 | Время ответа | В заявке отображается время ответа (в минутах) | ☐ |

---

## Тест 3: Несколько бухгалтеров на одном чате

### Шаги:

1. В настройках чата добавьте @username двух разных бухгалтеров
2. Сохраните настройки
3. Отправьте тестовое сообщение от клиента
4. Пусть **второй** бухгалтер (чей @username тоже указан) ответит на сообщение

### Что проверить:

| # | Проверка | Ожидаемый результат | ✓/✗ |
|---|----------|---------------------|-----|
| 1 | Ответ второго бухгалтера | Заявка также закрылась (статус «Отвечено») | ☐ |
| 2 | В системе | Оба бухгалтера распознаются корректно | ☐ |

---

## Тест 4: Проверка в таблице заявок

### Шаги:

1. Откройте раздел **«Заявки»** в веб-панели
2. Найдите заявку, на которую вы отвечали

### Что проверить:

| # | Проверка | Ожидаемый результат | ✓/✗ |
|---|----------|---------------------|-----|
| 1 | Столбец «Ответ бухгалтера» | Отображается текст вашего ответа | ☐ |
| 2 | Статус заявки | Отображается «Отвечено» | ☐ |
| 3 | Время ответа | Показано время в минутах | ☐ |

---

## Возможные проблемы и решения

### Проблема: Мой ответ не закрывает заявку

**Проверьте:**
1. Ваш @username точно добавлен в настройках чата?
2. @username написан без ошибок?
3. Вы отвечаете с того же аккаунта Telegram?

**Решение:** Откройте настройки чата и проверьте список добавленных @username

---

### Проблема: Не могу добавить @username

**Возможные причины:**
- Username слишком короткий (минимум 5 символов)
- Username содержит недопустимые символы
- Username начинается или заканчивается на `_`

**Решение:** Введите username только из букв, цифр и `_` (от 5 до 32 символов)

---

### Проблема: Сообщение об ошибке при сохранении

**Решение:**
1. Обновите страницу
2. Попробуйте сохранить ещё раз
3. Если ошибка повторяется — сообщите разработчику

---

## Форма обратной связи

После тестирования, пожалуйста, заполните:

**Ваше имя:** _______________

**Дата тестирования:** _______________

**Результаты:**

| Тест | Пройден? | Комментарий |
|------|----------|-------------|
| Тест 1: Добавление @username | ☐ Да / ☐ Нет | |
| Тест 2: Распознавание в Telegram | ☐ Да / ☐ Нет | |
| Тест 3: Несколько бухгалтеров | ☐ Да / ☐ Нет | |
| Тест 4: Таблица заявок | ☐ Да / ☐ Нет | |

**Что работает хорошо:**

_________________________________________________

**Что не работает или работает плохо:**

_________________________________________________

**Пожелания и предложения:**

_________________________________________________

---

## Контакты для вопросов

Если что-то непонятно или возникли проблемы — пишите разработчику.

---

*Спасибо за помощь в тестировании!*
